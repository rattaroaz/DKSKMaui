@using Microsoft.AspNetCore.Components.Web
@inject ILogger<CustomErrorBoundary> Logger

<ErrorBoundary>
    <ChildContent>
        @ChildContent
    </ChildContent>
    <ErrorContent Context="exception">
        <div class="alert alert-danger" role="alert">
            <h4 class="alert-heading">
                <i class="fas fa-exclamation-triangle"></i> Something went wrong
            </h4>
            <p>An unexpected error occurred. Please try refreshing the page or contact support if the problem persists.</p>
            @if (ShowDetails)
            {
                <hr>
                <p class="mb-0"><strong>Error Details:</strong> @exception.Message</p>
            }
            <div class="mt-3">
                <button class="btn btn-primary" @onclick="Recover">
                    <i class="fas fa-redo"></i> Try Again
                </button>
                <button class="btn btn-secondary ms-2" @onclick="ToggleDetails">
                    @(ShowDetails ? "Hide" : "Show") Details
                </button>
            </div>
        </div>
    </ErrorContent>
</ErrorBoundary>

@code {
    [Parameter] public RenderFragment ChildContent { get; set; }
    [Parameter] public bool ShowDetails { get; set; } = false;

    private void Recover()
    {
        // This will cause the ErrorBoundary to re-render its content
        StateHasChanged();
    }

    private void ToggleDetails()
    {
        ShowDetails = !ShowDetails;
        StateHasChanged();
    }

    protected override void OnParametersSet()
    {
        // This method is called when parameters change
        // The error handling is done in the ErrorContent section above
    }
}
